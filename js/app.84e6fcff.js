!function(){"use strict";var e,t={7061:function(e,t,r){function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function i(e,t,r,n,i,a,o){try{var s=e[a](o),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function a(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function s(e){i(o,n,a,s,u,"next",e)}function u(e){i(o,n,a,s,u,"throw",e)}s(void 0)}))}}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}function s(e,t){return s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},s(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h(e);if(t){var i=h(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return c(this,r)}}function c(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function p(e,t,r){return t&&f(e.prototype,t),r&&f(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function m(){var t=this,r={};return Object.keys(e.__proto__.exports).filter((function(e){return"getAliasMap"!=e})).forEach((function(e){t[e].aliases&&t[e].aliases().forEach((function(n){return r[n]=t[e]}))})),r}r.r(t),r.d(t,{getAliasMap:function(){return m},echo:function(){return b},uid:function(){return g},ssh:function(){return k},buy:function(){return x},network:function(){return T},nick:function(){return R},exit:function(){return S},money:function(){return G},bc:function(){return M},ls:function(){return C}}),r(5666),r(1539),r(4747),r(7327),r(7941),r(8674),r(7042),r(9600),r(8304),r(489),r(2419),r(2526),r(1817),r(2165),r(6992),r(8783),r(3948),e=r.hmd(e);var d=function(e){return new Promise((function(t){return setTimeout(t,e)}))},v="network",y=function(){function e(){l(this,e)}return p(e,null,[{key:"getContexts",value:function(){return[v]}}]),e}(),w=function(){function e(){l(this,e)}return p(e,null,[{key:"getContexts",value:function(){return["vm"]}}]),e}(),b=function(e){o(n,e);var t,r=u(n);function n(){return l(this,n),r.apply(this,arguments)}return p(n,null,[{key:"help",value:function(){return"Echos text back to the terminal."}},{key:"run",value:(t=a(regeneratorRuntime.mark((function e(){var t,r=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Array.prototype.slice.call(r),this.write(t.join(" "));case 2:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),n}(y),g=function(e){o(n,e);var t,r=u(n);function n(){return l(this,n),r.apply(this,arguments)}return p(n,null,[{key:"help",value:function(){return"Returns your user id on the server."}},{key:"run",value:(t=a(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.write(this.user.uid);case 1:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),n}(y),k=function(e){o(n,e);var t,r=u(n);function n(){return l(this,n),r.apply(this,arguments)}return p(n,null,[{key:"help",value:function(){return"Connect to a remote server."}},{key:"run",value:(t=a(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.connectedTo.length>0)){e.next=5;break}return this.write("You are already connected to a server."),e.abrupt("return");case 5:if(t){e.next=10;break}return this.write("Invalid address."),e.abrupt("return");case 10:if(!(t.length<this.Game.VMs.network.length)){e.next=15;break}return this.write("Invalid address: ".concat(t)),e.abrupt("return");case 15:if(t.substr(0,this.Game.VMs.network.length)==this.Game.VMs.network){e.next=18;break}return this.write("Address not in current network: ".concat(t)),e.abrupt("return");case 18:return this.write("Connecting to {magenta}".concat(t,"{reset}..")),e.next=21,d(1e3);case 21:if(r=this.Game.VMs.getServer(t)){e.next=25;break}return this.write("No response.\n\n\rThere does not appear to be an active VM running at that address. You can purchase a VM there for {yellow}$100{reset} by running {yellow}buy ".concat(t,"{reset}.")),e.abrupt("return");case 25:if(r.owner.uid==this.userUid){e.next=28;break}return this.write("You are not able to authenticate to this server."),e.abrupt("return");case 28:this.write("\r\nConnected."),this.setConnection(t),this.updatePrompt();case 31:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),n}(y),x=function(e){o(n,e);var t,r=u(n);function n(){return l(this,n),r.apply(this,arguments)}return p(n,null,[{key:"help",value:function(){return"Purchase a VM."}},{key:"run",value:(t=a(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t){e.next=4;break}return this.write("You must specify the IP address of the VM that you wish to buy."),e.abrupt("return");case 4:return e.next=6,this.Game.CloudFuncs.buyServer({ip:t});case 6:this.write("Server purchased."),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),this.write(e.t0.message);case 12:case"end":return e.stop()}}),e,this,[[0,9]])}))),function(e){return t.apply(this,arguments)})}]),n}(y),T=function(e){o(n,e);var t,r=u(n);function n(){return l(this,n),r.apply(this,arguments)}return p(n,null,[{key:"help",value:function(){return"Network settings."}},{key:"run",value:(t=a(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.write("You are on the {magenta}".concat(this.Game.VMs.network,".0.0{reset} network."));case 1:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),n}(y),R=function(e){o(n,e);var t,r=u(n);function n(){return l(this,n),r.apply(this,arguments)}return p(n,null,[{key:"help",value:function(){return"Nick settings."}},{key:"run",value:(t=a(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=3;break}return this.write("Your nick is {cyan}".concat(this.user.nick,"{reset}.")),e.abrupt("return");case 3:return e.next=5,this.Game.FB.updateUser({nick:t});case 5:this.write("Nick changed."),this.updatePrompt();case 7:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),n}(y),S=function(e){o(n,e);var t,r=u(n);function n(){return l(this,n),r.apply(this,arguments)}return p(n,null,[{key:"help",value:function(){return"Logout."}},{key:"aliases",value:function(){return["logout"]}},{key:"prompt",value:function(){return!1}},{key:"getContexts",value:function(){return[v,"vm"]}},{key:"run",value:(t=a(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.connectedTo.length>0)){e.next=6;break}return this.write("Disconnected."),this.setConnection(),this.updatePrompt(),this.prompt(),e.abrupt("return");case 6:this.logOut(),this.write("Logged out. Goodbye!");case 8:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),n}(y),G=function(e){o(n,e);var t,r=u(n);function n(){return l(this,n),r.apply(this,arguments)}return p(n,null,[{key:"help",value:function(){return"Displays how much money you have."}},{key:"run",value:(t=a(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.write("You have {yellow}$".concat(this.user.money,"{reset}."));case 1:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),n}(y),M=function(e){o(n,e);var t,r=u(n);function n(){return l(this,n),r.apply(this,arguments)}return p(n,null,[{key:"help",value:function(){return"Broadcast a message"}},{key:"run",value:(t=a(regeneratorRuntime.mark((function e(){var t,r=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Array.prototype.slice.call(r),e.next=3,this.Game.CloudFuncs.broadcastMessage({message:t.join(" ")});case 3:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),n}(y),C=function(e){o(n,e);var t,r=u(n);function n(){return l(this,n),r.apply(this,arguments)}return p(n,null,[{key:"run",value:(t=a(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.write("Test");case 1:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),n}(w)},2850:function(e,t,r){r(1539),r(8674),r(5666);var n=r(1644);function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var o=a((function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.Game=t,this.functions=(0,n.$C)(t.FB.app),this.initUserData=(0,n.V1)(this.functions,"initUserData"),this.buyServer=(0,n.V1)(this.functions,"buyServer"),this.broadcastMessage=(0,n.V1)(this.functions,"broadcastMessage")})),s=(r(4747),r(2222),r(4916),r(3123),r(5503)),u=r(1591),c=r(9474);function h(e,t,r,n,i,a,o){try{var s=e[a](o),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function l(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function o(e){h(a,n,i,o,s,"next",e)}function s(e){h(a,n,i,o,s,"throw",e)}o(void 0)}))}}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var p={apiKey:"AIzaSyA2qhifXmyniOlmj7byorgIc1Ek71JoxOI",authDomain:"bytenet-1ae2e.firebaseapp.com",projectId:"bytenet-1ae2e",storageBucket:"bytenet-1ae2e.appspot.com",messagingSenderId:"463778527382",appId:"1:463778527382:web:b7053120b0aab8e986aab7",measurementId:"G-PP831X98S2"},m=function(){function e(t){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.Game=t,this.app=(0,s.ZF)(p),this.db=(0,u.ad)(this.app),this.auth=(0,c.v0)(this.app),this.subs={user:null,servers:null,messages:null},this.messagesInitialized=!1,(0,c.Aj)(this.auth,function(){var e=l(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=3;break}return r.Game.Term.auth(),e.abrupt("return");case 3:r.Game.Term.userUid=t.uid,r.subs.user=(0,u.cf)((0,u.JU)(r.db,"users",t.uid),(function(e){e.exists()&&(r.Game.Term.user=e.data(),r.Game.VMs.setNetwork(e.data().network),"TERMINAL_STATE_PREAUTH"!=r.Game.Term.state&&"TERMINAL_STATE_LOGIN_PASSWORD"!=r.Game.Term.state&&"TERMINAL_STATE_LOGIN_CREATE"!=r.Game.Term.state||r.Game.Term.loggedIn())}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}var t,r,n,i,a,o,h,m,d;return t=e,r=[{key:"listenToServers",value:function(e){this.subs.servers&&this.subs.servers(),this.subs.servers=(0,u.cf)((0,u.IO)((0,u.hJ)(this.db,"networks/".concat(e,"/servers"))),this.handleServerCollectionUpdate.bind(this))}},{key:"listenToMessages",value:function(e){this.subs.messages&&(this.subs.messages(),this.messagesInitialized=!1),this.subs.messages=(0,u.cf)((0,u.IO)((0,u.hJ)(this.db,"networks/".concat(e,"/messages"))),this.handleMessageCollectionUpdate.bind(this))}},{key:"handleServerCollectionUpdate",value:(d=l(regeneratorRuntime.mark((function e(t){var r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.docChanges().forEach(function(){var e=l(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.type,e.next="added"===e.t0||"modified"===e.t0?3:"removed"===e.t0?5:8;break;case 3:return r.Game.VMs.servers[t.doc.data().ip]=t.doc.data(),e.abrupt("break",8);case 5:return delete r.Game.VMs.servers[t.doc.data().ip],e.next=8,r.Game.VMs.handleServerData(t.doc.data().ip,null);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),this.Game.VMs.resync();case 2:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"handleMessageCollectionUpdate",value:(m=l(regeneratorRuntime.mark((function e(t){var r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.messagesInitialized){e.next=3;break}return this.messagesInitialized=!0,e.abrupt("return");case 3:t.docChanges().forEach((function(e){"added"==e.type&&r.Game.Term.writeAlways("[".concat(e.doc.data().nick,"] ").concat(e.doc.data().message))}));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return m.apply(this,arguments)})},{key:"login",value:(h=l(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,c.Fb)(this.auth,c.a$);case 3:return e.next=5,(0,c.e5)(this.auth,t,r);case 5:e.next=27;break;case 7:e.prev=7,e.t0=e.catch(0),e.t1=e.t0.code,e.next="auth/user-not-found"===e.t1?12:"auth/wrong-password"===e.t1?14:"auth/invalid-email"===e.t1?17:"auth/weak-password"===e.t1?20:23;break;case 12:return this.Game.Term.promptCreateAccount(),e.abrupt("break",27);case 14:return this.Game.Term.write("{red}Invalid password.{reset}"),this.Game.Term.auth(),e.abrupt("break",27);case 17:return this.Game.Term.write("{red}Email address is invalid.{reset}"),this.Game.Term.auth(),e.abrupt("break",27);case 20:return this.Game.Term.write("{red}Password should be stronger.{reset}"),this.Game.Term.auth(),e.abrupt("break",27);case 23:return this.Game.Term.write("{red}Unknown problem. Check console.{reset}"),this.Game.Term.auth(),console.log(e.t0),e.abrupt("break",27);case 27:case"end":return e.stop()}}),e,this,[[0,7]])}))),function(e,t){return h.apply(this,arguments)})},{key:"logout",value:(o=l(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,c.w7)(this.auth);case 2:this.subs.user(),this.subs.servers();case 4:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"create",value:(a=l(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,c.Xb)(this.auth,t,r);case 3:return this.Game.Term.write("{green}User created.{reset}"),this.Game.Term.write("{green}Initializing user..{reset}"),e.next=7,this.Game.CloudFuncs.initUserData({nick:t.split("@")[0]});case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:case"end":return e.stop()}}),e,this,[[0,9]])}))),function(e,t){return a.apply(this,arguments)})},{key:"updateUser",value:(i=l(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,u.r7)((0,u.JU)(this.db,"users",this.auth.currentUser.uid),t);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0);case 8:case"end":return e.stop()}}),e,this,[[0,5]])}))),function(e){return i.apply(this,arguments)})},{key:"getUserData",value:(n=l(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t.type&&"document"==t.type){e.next=3;break}return e.abrupt("return",t);case 3:return e.next=5,(0,u.QT)(t);case 5:return e.abrupt("return",e.sent.data());case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])}))),function(e){return n.apply(this,arguments)})}],r&&f(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),d=r(1766);function v(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var y=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._music=new d.Howl({src:["sfx/music.mp3"],loop:!0,autoplay:!0}),this._beep=new d.Howl({src:["sfx/beep.wav"]})}var t,r;return t=e,(r=[{key:"beep",value:function(){this._beep.play()}}])&&v(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),w=(r(5306),r(2320)),b=r(7061);function g(e,t,r,n,i,a,o){try{var s=e[a](o),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function k(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var x={cursorBlink:!0,theme:{foreground:"#86eb8a",background:"#282a36",selection:"#97979b33",black:"#282a36",brightBlack:"#686868",red:"#ff5c57",brightRed:"#ff5c57",green:"#5af78e",brightGreen:"#5af78e",yellow:"#e7f24e",brightYellow:"#e7f24e",blue:"#57c7ff",brightBlue:"#57c7ff",magenta:"#ff6ac1",brightMagenta:"#ff6ac1",cyan:"#00e5ff",brightCyan:"#00e5ff",white:"#f1f1f0",brightWhite:"#eff0eb"}},T="TERMINAL_STATE_LOGIN_EMAIL",R="TERMINAL_STATE_LOGIN_PASSWORD",S="TERMINAL_STATE_LOGIN_CREATE",G="TERMINAL_STATE_SHELL",M=function(){function e(t){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.Game=t,this.command="",this.promptString="$ ",this.promptCutoff=2,this.state="TERMINAL_STATE_PREAUTH",this.loginEmail="",this.loginPassword="",this.user={},this.userUid="",this.history=[],this.isLoading=!1,this.connectedTo="",this.term=new w.Terminal(x),this.term.open(document.getElementById("terminal")),window.addEventListener("resize",(function(){return r.resize()})),this.resize(),this.greeting(),this.term.focus(),this.term.onData((function(e){if(!r.isLoading)switch(e){case"":r.term.write("^C"),r.command="",r.prompt();break;case"\r":if(0==r.command.length)return void r.prompt();r.runCommand();break;case"":r.term._core.buffer.x>r.promptCutoff&&(r.term.write("\b \b"),r.command.length>0&&(r.command=r.command.substr(0,r.command.length-1)));break;default:if(e>=String.fromCharCode(32)&&e<=String.fromCharCode(123)||e>=" "){if(r.state==R)r.term.write("*");else if(r.state==S){if(1==r.command.length||"y"!=e&&"Y"!=e&&"n"!=e&&"N"!=e)return;r.term.write(e)}else r.term.write(e);r.command+=e}}})),this.term.onKey((function(e){if("ArrowUp"==e.domEvent.code){var t=r.history[r.history.length-1];r.term.write(t),r.command=t}}))}var t,r,n,i;return t=e,r=[{key:"resize",value:function(){var e=Math.floor(window.innerHeight/19);this.term.resize(70,e)}},{key:"greeting",value:function(){this.write("Welcome to the [1;3;31mBytenet[0m!")}},{key:"auth",value:function(){this.state=T,this.command="",this.prompt("email: ")}},{key:"promptCreateAccount",value:function(){this.state=S,this.prompt("User not found. Create? (Y/N): ")}},{key:"setConnection",value:function(e){if(!e)return this.Game.VMs.div(this.connectedTo).classList.remove("connected"),void(this.connectedTo="");this.connectedTo=e,this.Game.VMs.div(e).classList.add("connected")}},{key:"removeColoring",value:function(e){return e.replace(/[\u001b\u009b][[()#;?]*(?:[0-9]{1,4}(?:;[0-9]{0,4})*)?[0-9A-ORZcf-nqry=><]/g,"")}},{key:"prompt",value:function(e){e&&(this.promptString=e,this.promptCutoff=this.removeColoring(this.promptString).length),0!=this.promptString.length&&(this.setLoadingState(!1),this.term.write("\r\n"+this.promptString))}},{key:"addToPrompt",value:function(e){return!this.isLoading&&(this.write(e,!0),this.command+=e,!0)}},{key:"setLoadingState",value:function(e){this.isLoading=e,e?document.querySelector("#terminal-loading").classList.add("visible"):document.querySelector("#terminal-loading").classList.remove("visible")}},{key:"write",value:function(e,t){e=(e=(e=(e=(e=(e=e.replace(/\{red\}/g,"[31m")).replace(/\{green\}/g,"[32m")).replace(/\{yellow\}/g,"[33m")).replace(/\{magenta\}/g,"[35m")).replace(/\{cyan\}/g,"[36m")).replace(/\{reset\}/g,"[0m"),t?this.term.write(e):this.term.writeln(e),this.Game.SFX.beep()}},{key:"writeAlways",value:function(e){this.isLoading?this.write("\n\r".concat(e)):(this.term.write("[2K\r"),this.write("\r".concat(e)),this.prompt(),this.write(this.command,!0))}},{key:"loggedIn",value:function(){this.write("\r\nLogged into the {magenta}".concat(this.Game.VMs.network,".0.0{reset} network.")),this.state=G,this.Game.VMs.show(),this.updatePrompt(),this.prompt()}},{key:"logOut",value:function(){this.user={},this.userUid="",this.Game.FB.logout(),this.Game.VMs.hide()}},{key:"updatePrompt",value:function(){var e="";this.connectedTo&&(e="[[33m"+this.connectedTo+"[0m] "),this.promptString=e+"([36m"+this.user.nick+"[0m) $ ",this.promptCutoff=this.removeColoring(this.promptString).length}},{key:"runCommand",value:(n=regeneratorRuntime.mark((function e(){var t,r,n,i,a,o,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.setLoadingState(!0),this.state!=T){e.next=8;break}this.loginEmail=this.command,this.command="",this.state=R,this.prompt("password: "),e.next=53;break;case 8:if(this.state!=R){e.next=15;break}this.loginPassword=this.command,this.command="",this.write("\r\n\nValidating credentials.."),this.Game.FB.login(this.loginEmail,this.loginPassword),e.next=53;break;case 15:if(this.state!=S){e.next=20;break}"y"==this.command.toLowerCase()?(this.Game.FB.create(this.loginEmail,this.loginPassword),this.write("")):"n"==this.command.toLowerCase()&&(this.write("\r\n"),this.auth()),this.command="",e.next=53;break;case 20:if(this.state!=G){e.next=53;break}if(t=this.command.split(" "),this.history.push(this.command),this.command="",this.write(""),r=t.shift().toLowerCase(),n=b[r]||null){e.next=36;break}if(!(i=b.getAliasMap())[r]){e.next=33;break}n=i[r],e.next=36;break;case 33:return this.write("Command not found: "+r),this.prompt(),e.abrupt("return");case 36:if(a=n.getContexts(),!(o=this.connectedTo.length>0)||-1!=a.indexOf("vm")){e.next=44;break}return this.write("You cannot run that command on a server. Disconnect first."),this.prompt(),e.abrupt("return");case 44:if(o||-1!=a.indexOf("network")){e.next=48;break}return this.write("You must be connected to a server first."),this.prompt(),e.abrupt("return");case 48:return e.next=50,n.run.apply(this,t);case 50:s=!0,n.prompt&&(s=n.prompt.apply(this,t)),s&&this.prompt();case 53:case"end":return e.stop()}}),e,this)})),i=function(){var e=this,t=arguments;return new Promise((function(r,i){var a=n.apply(e,t);function o(e){g(a,r,i,o,s,"next",e)}function s(e){g(a,r,i,o,s,"throw",e)}o(void 0)}))},function(){return i.apply(this,arguments)})}],r&&k(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function C(e,t,r,n,i,a,o){try{var s=e[a](o),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function E(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r(7941);var O=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.Game=t,this.container=document.querySelector(".vm-container"),this.network="0.0",this.servers={}}var t,r,n,i;return t=e,r=[{key:"_addVMsToRow",value:function(e,t){for(var r=this,n=function(n){var i="".concat(r.network,".").concat(e+1,".").concat(n+1),a=document.createElement("div");a.className="vm",a.setAttribute("ip",i);var o=document.createElement("div");o.className="ip-address",a.appendChild(o);var s=document.createElement("div");s.className="owner",a.appendChild(s);var u=document.createElement("div");u.className="specs",a.appendChild(u),a.addEventListener("click",(function(e){var t=document.querySelector('.vm.owned[ip="'.concat(i,'"]'));if(r.Game.Term.term.focus(),e.shiftKey)r.Game.Term.addToPrompt(i);else{if(t){if(!r.Game.Term.addToPrompt("ssh ".concat(i)))return!1}else if(!r.Game.Term.addToPrompt("buy ".concat(i)))return!1;r.Game.Term.runCommand()}})),t.appendChild(a),r.initVM(i)},i=0;i<=8;i++)n(i)}},{key:"show",value:function(){this.container.classList.remove("hidden")}},{key:"hide",value:function(){this.container.classList.add("hidden")}},{key:"setup",value:function(){for(var e=0;e<=8;e++){var t=document.createElement("div");t.className="row-container",this.container.appendChild(t),this._addVMsToRow(e,t)}}},{key:"getServer",value:function(e){return this.servers[e]?this.servers[e]:null}},{key:"div",value:function(e){return this.container.querySelector('[ip="'.concat(e,'"]'))}},{key:"setNetwork",value:function(e){this.network!=e&&(this.container.innerHTML="",this.network=e,this.setup(),this.Game.FB.listenToServers(e),this.Game.FB.listenToMessages(e),this.resync(),console.log("Network changed",e))}},{key:"initVM",value:function(e){var t=document.querySelector('[ip="'.concat(e,'"]'));t.className="vm";var r=t.querySelector(".ip-address");r.className="ip-address",r.innerText=e;var n=t.querySelector(".owner");n.className="owner",n.innerHTML='<span class="buy-cost">$100</span>';var i=t.querySelector(".specs");i.className="specs",i.innerHTML="",i.classList.add("hidden")}},{key:"handleServerData",value:(n=regeneratorRuntime.mark((function e(t,r){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.substr(0,this.network.length)==this.network){e.next=2;break}return e.abrupt("return");case 2:if(r){e.next=6;break}return this.initVM(t),console.log("removed server",t),e.abrupt("return");case 6:if(!r.owner){e.next=21;break}return e.next=9,this.Game.FB.getUserData(r.owner);case 9:r.owner=e.sent,document.querySelector('[ip="'.concat(t,'"]')).classList.add("owned"),document.querySelector('[ip="'.concat(t,'"] .owner')).innerHTML='<div class="name">'.concat(r.owner.nick,"</div>"),(n=document.querySelector('[ip="'.concat(t,'"] .specs'))).classList.remove("hidden"),n.innerHTML="<div>",n.innerHTML+='<div>cpu: <span class="stat">100m</span></div>',n.innerHTML+='<div>mem: <span class="stat">1Gi</span></div>',n.innerHTML+='<div>disk: <span class="stat">100Gi</span></div>',n.innerHTML+="</div>";case 21:this.Game.VMs.servers[r.ip]=r,console.log("updated server",r);case 23:case"end":return e.stop()}}),e,this)})),i=function(){var e=this,t=arguments;return new Promise((function(r,i){var a=n.apply(e,t);function o(e){C(a,r,i,o,s,"next",e)}function s(e){C(a,r,i,o,s,"throw",e)}o(void 0)}))},function(e,t){return i.apply(this,arguments)})},{key:"resync",value:function(){var e=this;Object.keys(this.servers).forEach((function(t){e.handleServerData(t,e.servers[t])}))}}],r&&E(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function P(e,t,r,n,i,a,o){try{var s=e[a](o),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function L(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function o(e){P(a,n,i,o,s,"next",e)}function s(e){P(a,n,i,o,s,"throw",e)}o(void 0)}))}}var A={};function _(){return j.apply(this,arguments)}function j(){return(j=L(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("./sha.txt");case 2:return t=e.sent,e.next=5,t.text();case 5:A.SHA=e.sent;case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}A.SFX=new y(A),A.FB=new m(A),A.Term=new M(A),A.VMs=new O(A),A.CloudFuncs=new o(A),A.SHA="",_(),setInterval(L(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=A.SHA,e.next=3,_();case 3:t!=A.SHA&&A.Term.writeAlways("{yellow}[!]{reset} An update is available! Refresh soon.");case 4:case"end":return e.stop()}}),e)}))),6e4),window.Game=A}},r={};function n(e){var i=r[e];if(void 0!==i)return i.exports;var a=r[e]={id:e,loaded:!1,exports:{}};return t[e](a,a.exports,n),a.loaded=!0,a.exports}n.m=t,e=[],n.O=function(t,r,i,a){if(!r){var o=1/0;for(h=0;h<e.length;h++){r=e[h][0],i=e[h][1],a=e[h][2];for(var s=!0,u=0;u<r.length;u++)(!1&a||o>=a)&&Object.keys(n.O).every((function(e){return n.O[e](r[u])}))?r.splice(u--,1):(s=!1,a<o&&(o=a));if(s){e.splice(h--,1);var c=i();void 0!==c&&(t=c)}}return t}a=a||0;for(var h=e.length;h>0&&e[h-1][2]>a;h--)e[h]=e[h-1];e[h]=[r,i,a]},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.hmd=function(e){return(e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:function(){throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,r){var i,a,o=r[0],s=r[1],u=r[2],c=0;if(o.some((function(t){return 0!==e[t]}))){for(i in s)n.o(s,i)&&(n.m[i]=s[i]);if(u)var h=u(n)}for(t&&t(r);c<o.length;c++)a=o[c],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return n.O(h)},r=self.webpackChunkwebpack_starter=self.webpackChunkwebpack_starter||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var i=n.O(void 0,[969],(function(){return n(2850)}));i=n.O(i)}();
//# sourceMappingURL=app.84e6fcff.js.map